<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏ñ‡πÇ‡∏°‡πà‡∏õ‡∏π‡∏ô (‡∏â‡∏ö‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: "Vibrant Professional" (Professional, high-contrast palette)
         Primary Blue (Header/Data): #1E3A8A (blue-900)
         Winner Green (Highlight): #10B981 (emerald-500)
         Accent Yellow (Fuel): #F59E0B (amber-500)
         Accent Purple (Maintenance/Maint): #8B5CF6 (violet-500)
    -->

    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #F3F4F6;
            color: #1F2937;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .stat-box {
            background-color: #F0F9FF; 
            border: 1px solid #BFDBFE; 
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .stat-value {
            font-weight: 800;
            background: -webkit-linear-gradient(45deg, #1E3A8A, #06B6D4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>

    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
</head>
<body id="report-root">

    <!-- Header & Executive Summary -->
    <header class="bg-blue-900 text-white p-8 md:p-12 shadow-2xl sticky top-0 z-40">
        <h1 class="text-3xl md:text-4xl font-extrabold mb-2">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô: ‡∏£‡∏ñ‡πÇ‡∏°‡πà‡∏õ‡∏π‡∏ô‡πÉ‡∏´‡∏°‡πà 1 ‡∏Ñ‡∏±‡∏ô</h1>
        <p class="text-lg opacity-80">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏µ (TCO) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏á‡∏≤‡∏ô 3,852.67 ‡∏Ñ‡∏¥‡∏ß (‡∏ï‡πà‡∏≠‡∏Ñ‡∏±‡∏ô)</p>
    </header>

    <!-- Export PDF Floating Button (‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏Ñ‡∏õ‡∏•‡∏á PDF) -->
    <button
        data-html2canvas-ignore="true"
        onclick="exportPDF()"
        class="fixed bottom-4 right-4 z-50 px-4 py-2 rounded-full shadow-lg bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-semibold flex items-center gap-2"
    >
        üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏õ‡πá‡∏ô PDF
    </button>

    <main class="max-w-7xl mx-auto px-4 py-8">

        <!-- Executive Verdict -->
        <section class="mb-8">
            <div class="card border-l-8 border-emerald-500 p-6 md:p-8">
                <h2 class="text-2xl font-bold text-gray-700 uppercase tracking-wider mb-3">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à (Executive Verdict)</h2>
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div class="mb-4 md:mb-0">
                        <h3 class="text-4xl font-extrabold text-emerald-600 mb-2">‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
                        <p class="text-xl text-gray-700">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠ <strong>‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠</strong> ‡πÅ‡∏•‡∏∞‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å <strong>4 ‡∏Ñ‡∏¥‡∏ß/‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</strong></p>
                    </div>
                    <div class="text-center bg-emerald-50 rounded-xl p-4 shadow-md">
                        <p class="text-gray-600 text-sm mb-1">‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏° (‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö 10 ‡∏•‡πâ‡∏≠)</p>
                        <p class="text-4xl font-extrabold text-emerald-600">1.73 ‡∏•‡∏ö.</p>
                        <p class="text-gray-500 text-sm mt-1">‡∏ï‡πà‡∏≠‡∏õ‡∏µ</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Financial Analysis Section -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="col-span-1 md:col-span-2">
                <h2 class="text-2xl font-bold text-blue-900 mb-4 border-b pb-2">1. ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏µ (TCO)</h2>
                <p class="text-gray-700">‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ô‡∏µ‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏´‡∏±‡∏Å‡∏•‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>
            </div>
            
            <!-- Chart 1: TCO Comparison -->
            <div class="card">
                <h3 class="text-xl font-semibold mb-4">1.1 ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏µ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö (THB)</h3>
                <div class="chart-container">
                    <canvas id="tcoChart"></canvas>
                </div>
            </div>

            <!-- Chart 2: Cost Breakdown -->
            <div class="card">
                <h3 class="text-xl font-semibold mb-4">1.2 ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô TCO (Stacked Analysis)</h3>
                <div class="chart-container">
                    <canvas id="breakdownChart"></canvas>
                </div>
            </div>
            
             <!-- Key Financial Metrics Table -->
            <div class="col-span-1 md:col-span-2 card p-4">
                <h3 class="text-xl font-semibold mb-3">1.3 ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (1 ‡∏õ‡∏µ)</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ã‡∏∑‡πâ‡∏≠ (‡∏ö‡∏≤‡∏ó)</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (‡∏ö‡∏≤‡∏ó)</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">TCO (‡∏ö‡∏≤‡∏ó)</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô/‡∏Ñ‡∏¥‡∏ß (‡∏ö‡∏≤‡∏ó/Q)</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">‡∏£‡∏ñ 10 ‡∏•‡πâ‡∏≠ (5Q)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">3,000,000</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">4,577,157</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">120,000</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold">7,697,157</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">1,997.88</td>
                            </tr>
                            <tr class="bg-emerald-50">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-emerald-800">‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (4Q - Max)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-medium">1,600,000</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-medium">4,258,478</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-medium">109,200</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-extrabold text-emerald-800">5,967,678</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-extrabold text-emerald-800">1,548.97</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (3Q - Proper)</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">1,600,000</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">5,671,329</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">84,000</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold">7,355,329</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right">1,909.13</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- New Section: Actual Trip Distribution -->
            <div class="col-span-1 md:col-span-2 card p-4">
                <h3 class="text-xl font-semibold mb-3">1.4 ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï.‡∏Ñ. 2568)</h3>
                <p class="text-sm text-gray-700 mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà (73.5%) ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏ñ‡πÇ‡∏°‡πà‡∏õ‡∏π‡∏ô 4 ‡∏Ñ‡∏¥‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (4Q) ‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤</p>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ß‡∏¥‡πà‡∏á (‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì)</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß (‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</th>
                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô (%)</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (4Q)</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì >= 4 Q</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold">477</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold text-emerald-600">73.5%</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 4Q (‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á 100% ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° 5Q)</td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì &lt; 4 Q</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold">172</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-semibold">26.5%</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà (3Q, 2Q, ‡∏Ø‡∏•‡∏Ø)</td>
                            </tr>
                            <tr class="bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-bold text-gray-900">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-extrabold">649</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-right font-extrabold">100%</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </section>

        <!-- Operational Analysis Section -->
        <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="col-span-1 md:col-span-2">
                <h2 class="text-2xl font-bold text-blue-900 mb-4 border-b pb-2">2. ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô</h2>
                <p class="text-gray-700">‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (4Q) ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏ó‡∏∏‡∏ô</p>
            </div>

            <!-- Operational Metrics -->
            <div class="card col-span-1">
                <h3 class="text-xl font-semibold mb-4">2.1 ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                <div class="space-y-4">
                    <div class="stat-box">
                        <p class="text-gray-500 text-sm">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ß‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≠‡∏õ‡∏µ</p>
                        <div class="flex justify-between items-center mt-1">
                            <span class="text-lg font-medium text-red-500">10 ‡∏•‡πâ‡∏≠: 771 ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</span>
                            <span class="text-lg font-bold text-emerald-600">6 ‡∏•‡πâ‡∏≠ (4Q): 964 ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">6 ‡∏•‡πâ‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏¥‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 25%</p>
                    </div>
                    <div class="stat-box">
                        <p class="text-gray-500 text-sm">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</p>
                        <div class="flex justify-between items-center mt-1">
                            <span class="text-lg font-medium text-red-500">10 ‡∏•‡πâ‡∏≠: 2.6 ‡∏Å‡∏°./‡∏•‡∏¥‡∏ï‡∏£</span>
                            <span class="text-lg font-bold text-emerald-600">6 ‡∏•‡πâ‡∏≠ (4Q): 3.5 ‡∏Å‡∏°./‡∏•‡∏¥‡∏ï‡∏£</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">6 ‡∏•‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏Å‡∏ß‡πà‡∏≤ 34.6%</p>
                    </div>
                    <div class="stat-box">
                        <p class="text-gray-500 text-sm">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡πà‡∏≠‡∏õ‡∏µ</p>
                        <div class="flex justify-between items-center mt-1">
                            <span class="text-lg font-medium text-red-500">10 ‡∏•‡πâ‡∏≠: 120,000 ‡∏ö‡∏≤‡∏ó</span>
                            <span class="text-lg font-bold text-emerald-600">6 ‡∏•‡πâ‡∏≠ (4Q): 109,200 ‡∏ö‡∏≤‡∏ó</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">6 ‡∏•‡πâ‡∏≠‡πÅ‡∏°‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡∏±‡∏Å ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤</p>
                    </div>
                </div>
            </div>

            <!-- Chart 3: Initial Investment Comparison (Doughnut) -->
            <div class="card col-span-1">
                <h3 class="text-xl font-semibold mb-4">2.2 ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</h3>
                <p class="text-sm text-gray-500 mb-6">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ‡∏ã‡∏∑‡πâ‡∏≠‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠ TCO ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="investmentChart"></canvas>
                </div>
            </div>

        </section>

        <!-- Strategic Recommendation Section -->
        <section class="mb-8">
            <h2 class="text-2xl font-bold text-blue-900 mb-4 border-b pb-2">3. ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card bg-indigo-50 border-t-4 border-indigo-500">
                    <h3 class="font-bold text-xl text-indigo-700 mb-2">3.1 ‡∏Å‡∏•‡∏¢‡∏∏‡∏ó‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å</h3>
                    <p class="text-sm text-gray-700">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà 4 ‡∏Ñ‡∏¥‡∏ß/‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô 30% ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô</p>
                </div>
                <div class="card bg-indigo-50 border-t-4 border-indigo-500">
                    <h3 class="font-bold text-xl text-indigo-700 mb-2">3.2 ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô (Fleet Management)</h3>
                    <p class="text-sm text-gray-700">‡πÉ‡∏ä‡πâ‡∏£‡∏ñ 10 ‡∏•‡πâ‡∏≠‡πÄ‡∏î‡∏¥‡∏° (5 ‡∏Ñ‡∏±‡∏ô) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î 5 ‡∏Ñ‡∏¥‡∏ß ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏¥‡∏° (‡∏£‡∏ß‡∏° 4 ‡∏Ñ‡∏±‡∏ô) ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô 4 ‡∏Ñ‡∏¥‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏£‡∏ñ‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</p>
                </div>
                 <div class="card bg-indigo-50 border-t-4 border-indigo-500">
                    <h3 class="font-bold text-xl text-indigo-700 mb-2">3.3 ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°</h3>
                    <p class="text-sm text-gray-700">‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å 4 ‡∏Ñ‡∏¥‡∏ß ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏ñ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (Preventive Maintenance) ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏á‡∏ö 109,200 ‡∏ö‡∏≤‡∏ó/‡∏õ‡∏µ</p>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-gray-800 text-gray-400 py-6 text-center text-sm">
        <p>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ ‡πÇ‡∏î‡∏¢‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï.‡∏Ñ. 2568</p>
    </footer>

    <script>
        // --- 1. Data Preparation (Calculated from 1/9 of total fleet volume: 3,852.67 Q/yr) ---
        const labels = ['‡∏£‡∏ñ 10 ‡∏•‡πâ‡∏≠ (5Q)', '‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (3Q)', '‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (4Q - ‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡∏™‡∏∏‡∏î)'];
        
        // Cost (THB)
        const costTotal = [7697157, 7355329, 5967678];
        const priceVehicles = [3000000, 1600000, 1600000];
        const costMaint = [120000, 84000, 109200];
        const costFuel = [4577157, 5671329, 4258478]; // Recalculated fuel: TCO - Purchase - Maint

        // --- 2. Chart.js Configuration Utilities ---

        Chart.defaults.font.family = "'Sarabun', sans-serif";
        Chart.defaults.color = '#4B5563';

        // Label Wrapping Logic (Mandatory)
        function formatLabel(label) {
            const maxChars = 16;
            if (label.length <= maxChars) return label;
            
            const words = label.split(' ');
            const lines = [];
            let currentLine = words[0];

            for (let i = 1; i < words.length; i++) {
                if (currentLine.length + 1 + words[i].length <= maxChars) {
                    currentLine += ' ' + words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        }

        const processedLabels = labels.map(formatLabel);

        // Tooltip Callback Configuration (Mandatory)
        const tooltipConfig = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                },
                label: function(context) {
                    let label = context.dataset.label || '';
                    if (label) {
                        label += ': ';
                    }
                    if (context.parsed.y !== null) {
                        let value = context.parsed.y;
                        if (value >= 1000000) {
                             label += (value / 1000000).toFixed(2) + ' ‡∏•‡∏ö.';
                        } else {
                             label += new Intl.NumberFormat('th-TH', { style: 'decimal', minimumFractionDigits: 0 }).format(value) + ' ‡∏ö‡∏≤‡∏ó';
                        }
                    }
                    return label;
                }
            }
        };
        
        // --- 3. Chart Implementations ---

        // Chart 1: TCO Comparison (Bar Chart)
        const ctxTCO = document.getElementById('tcoChart').getContext('2d');
        new Chart(ctxTCO, {
            type: 'bar',
            data: {
                labels: processedLabels,
                datasets: [{
                    label: '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏µ',
                    data: costTotal,
                    backgroundColor: [
                        '#9CA3AF', 
                        '#D1D5DB', 
                        '#10B981'  // Highlight Winner
                    ],
                    borderRadius: 8,
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: tooltipConfig,
                    title: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        grid: { color: '#E5E7EB' },
                        ticks: {
                            callback: function(value) {
                                return (value / 1000000) + ' ‡∏•‡∏ö.';
                            }
                        }
                    },
                    x: {
                        grid: { display: false }
                    }
                }
            }
        });

        // Chart 2: TCO Breakdown (Stacked Bar)
        const ctxBreakdown = document.getElementById('breakdownChart').getContext('2d');
        new Chart(ctxBreakdown, {
            type: 'bar',
            data: {
                labels: processedLabels,
                datasets: [
                    {
                        label: '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ (Purchase)',
                        data: priceVehicles,
                        backgroundColor: '#1E3A8A', // Primary Blue
                        stack: 'Stack 0',
                    },
                    {
                        label: '‡∏Ñ‡πà‡∏≤‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á (Maint)',
                        data: costMaint,
                        backgroundColor: '#8B5CF6', // Violet
                        stack: 'Stack 0',
                    },
                    {
                        label: '‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô (Fuel)',
                        data: costFuel,
                        backgroundColor: '#F59E0B', // Amber
                        stack: 'Stack 0',
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom', labels: { usePointStyle: true } },
                    tooltip: tooltipConfig
                },
                scales: {
                    y: {
                        stacked: true,
                        grid: { color: '#E5E7EB' },
                        ticks: {
                            callback: function(value) {
                                return (value / 1000000) + ' ‡∏•‡∏ö.';
                            }
                        }
                    },
                    x: {
                        stacked: true,
                        grid: { display: false }
                    }
                }
            }
        });
        
        // Chart 3: Initial Investment Comparison (Doughnut)
        const ctxInvestment = document.getElementById('investmentChart').getContext('2d');
        new Chart(ctxInvestment, {
            type: 'doughnut',
            data: {
                labels: ['‡∏£‡∏ñ 10 ‡∏•‡πâ‡∏≠ (3.0 ‡∏•‡∏ö.)', '‡∏£‡∏ñ 6 ‡∏•‡πâ‡∏≠ (1.6 ‡∏•‡∏ö.)'],
                datasets: [{
                    label: '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ñ',
                    data: [3000000, 1600000],
                    backgroundColor: [
                        '#3B82F6', // Blue for 10L
                        '#10B981'  // Emerald for 6L
                    ],
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    legend: { position: 'right' },
                    tooltip: {
                         callbacks: {
                            title: function(tooltipItems) {
                                return tooltipItems[0].label;
                            },
                            label: function(context) {
                                const total = context.chart._metasets[0].total;
                                const value = context.parsed;
                                const percentage = ((value / total) * 100).toFixed(1) + '%';
                                return context.label + ': ' + percentage;
                            }
                        }
                    }
                }
            }
        });

        // --- 4. Export PDF Function ---
        async function exportPDF() {
            const { jsPDF } = window.jspdf || window.jspdf || {};
            if (!jsPDF) {
                alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î jsPDF ‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                return;
            }

            const reportElement = document.getElementById('report-root');

            // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏±‡∏ô chart/canvas ‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß
            window.scrollTo(0, 0);

            const canvas = await html2canvas(reportElement, {
                scale: 2,
                useCORS: true,
                windowWidth: document.documentElement.scrollWidth,
                windowHeight: document.documentElement.scrollHeight
            });

            const imgData = canvas.toDataURL('image/png');
            const pdf = new jsPDF('l', 'mm', 'a4');

            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = pdf.internal.pageSize.getHeight();

            const imgWidth = pdfWidth;
            const imgHeight = canvas.height * pdfWidth / canvas.width;

            let heightLeft = imgHeight;
            let position = 0;

            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pdfHeight;

            while (heightLeft > 0) {
                position = heightLeft - imgHeight;
                pdf.addPage();
                pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pdfHeight;
            }

            pdf.save('truck-mixer-investment-report.pdf');
        }
    </script>
    <!-- NO SVG Graphics used. NO Mermaid JS used. -->
</body>
</html>
